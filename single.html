<!DOCTYPE html>
<html>
<head>
  <link rel="icon" href="1.ico" type="image/x-icon">
  <title>éª°å­è¨ˆæ•¸æ©Ÿ</title>
  <meta charset="UTF-8">
  <style>
    body { font-family: monospace; text-align: center; margin-top: 80px; background: #222; color: #fff; }
    select, button { font-size: 1.5em; margin: 5px; padding: 5px 20px; border-radius: 12px; border: none; background: #444; color: #fff; }
    button { background: #007bff; }
    #result { font-size: 3em; margin-top: 30px; transition: 0.2s; }
    #all { font-size: 1.2em; margin-top: 10px; }
    #sumCount { font-size: 2.5em; margin: 25px auto 10px auto; font-weight: bold; color: #ffd700; }
    table { margin: 0 auto 0 auto; border-collapse: collapse; }
    th, td { border: 1px solid #fff3; padding: 8px 16px; font-size: 1.2em; }
    th { background: #333; }
    td { background: #222; }
    /* æˆå°±è¦–çª— */
    #achievement {
      display: none;
      position: fixed;
      left: 0; right: 0; top: 0; bottom: 0;
      background: rgba(0,0,0,0.65);
      z-index: 999;
      justify-content: center;
      align-items: center;
    }
    #achievementBox {
      background: #444;
      color: #ffd700;
      border-radius: 22px;
      padding: 50px 40px 40px 40px;
      box-shadow: 0 0 40px #000b;
      font-size: 2em;
      font-weight: bold;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 320px;
      min-height: 120px;
      position: relative;
      animation: popin .3s;
    }
    @keyframes popin {
      from { transform: scale(0.7);}
      to { transform: scale(1);}
    }
    #closeBtn {
      margin-top: 35px;
      background: #ffd700;
      color: #222;
      border: none;
      border-radius: 14px;
      padding: 10px 35px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 12px #000a;
      transition: background .2s;
    }
    #closeBtn:hover { background: #fff04a; }
    #trophy {
      font-size: 2.2em;
      margin-bottom: 12px;
      filter: drop-shadow(0 0 4px #fff7);
    }
  </style>
</head>
<body>
  <h1>éª°å­è¨ˆæ•¸ çµ±è¨ˆä½ å¤šå»¢</h1>
  <div>
    <span>éª°å­é¡†æ•¸ï¼š</span>
    <select id="diceCount">
      <option value="1">1 é¡†</option>
      <option value="2">2 é¡†</option>
      <option value="3">3 é¡†</option>
    </select>
    <button id="btn" onclick="rollDice()">éª°ä¸‹å»å•¦ï¼</button>
    <button onclick="resetAll()">æ¸…ç©ºçµ±è¨ˆ</button>
  </div>
  <div id="result">é‚„æ²’éª°å•¦ æ€•å•¥</div>
  <div id="all"></div>

  <div id="sumCount">ç¸½å’Œï¼š0</div>
  <table>
    <thead>
      <tr>
        <th>é»æ•¸</th>
        <th>å‡ºç¾æ¬¡æ•¸</th>
      </tr>
    </thead>
    <tbody id="countTable">
      <tr><td>1 âš€</td><td id="cnt1">0</td></tr>
      <tr><td>2 âš</td><td id="cnt2">0</td></tr>
      <tr><td>3 âš‚</td><td id="cnt3">0</td></tr>
      <tr><td>4 âšƒ</td><td id="cnt4">0</td></tr>
      <tr><td>5 âš„</td><td id="cnt5">0</td></tr>
      <tr><td>6 âš…</td><td id="cnt6">0</td></tr>
    </tbody>
  </table>

  <!-- æˆå°±è¦–çª— -->
  <div id="achievement">
    <div id="achievementBox">
      <div id="trophy">ğŸ†</div>
      <div id="achieveTitle">æˆå°±é”æˆ</div>
      <div id="achieveDetail" style="margin-top:15px;"></div>
      <button id="closeBtn" onclick="closeAchieve()">æ”¶åˆ°å•¦å»¢ç‰©</button>
    </div>
  </div>

  <script>
    let rolling = false
    // è¨ˆæ•¸ç”¨çš„array 1~6
    let counts = [0,0,0,0,0,0]
    let totalSum = 0

    // æˆå°±ç´€éŒ„ï¼šé¿å…åŒä¸€æˆå°±ç‹‚è·³
    let achieveState = {
      sum100: false,
      sum500: false,
      sum1000: false,
      face10: [false, false, false, false, false, false],   // 1-6
      face20: [false, false, false, false, false, false],
      face50: [false, false, false, false, false, false],
      face100: [false, false, false, false, false, false],
    }

    function updateTable() {
      for(let i=1; i<=6; i++) {
        document.getElementById('cnt'+i).innerText = counts[i-1]
      }
      document.getElementById('sumCount').innerText = `ç¸½å’Œï¼š${totalSum}`
    }

    function resetAll() {
      counts = [0,0,0,0,0,0]
      totalSum = 0
      achieveState = {
        sum100: false,
        sum500: false,
        sum1000: false,
        face10: [false, false, false, false, false, false],
        face20: [false, false, false, false, false, false],
        face50: [false, false, false, false, false, false],
        face100: [false, false, false, false, false, false],
      }
      updateTable()
      document.getElementById('achievement').style.display = 'none'
      document.getElementById('result').innerHTML = 'é‚„æ²’éª°å•¦ æ€•å•¥'
      document.getElementById('all').innerHTML = ''
    }

    function showAchieve(title, detail, emoji="ğŸ†") {
      document.getElementById('achievement').style.display = 'flex'
      document.getElementById('achieveTitle').innerText = title
      document.getElementById('achieveDetail').innerText = detail
      document.getElementById('trophy').innerText = emoji
    }

    function closeAchieve() {
      document.getElementById('achievement').style.display = 'none'
    }

    function checkAchieve() {
      // ç¸½å’Œ
      if(totalSum >= 1000 && !achieveState.sum1000) {
        achieveState.sum1000 = true
        showAchieve("ç¸½å’Œç ´åƒï¼", "ä½ æ˜¯éª°åˆ°çˆ›æ‰‹å•¦ï¼ç¸½å’Œ 1000", "ğŸ”¥")
        return
      }
      if(totalSum >= 500 && !achieveState.sum500) {
        achieveState.sum500 = true
        showAchieve("éª°çˆ†äººç”Ÿ", "ç¸½å’Œ 500 é”æˆ ä½ å¾ˆé–’å—ï¼Ÿ", "ğŸ’ª")
        return
      }
      if(totalSum >= 100 && !achieveState.sum100) {
        achieveState.sum100 = true
        showAchieve("æˆå°±é”æˆ", "ç¸½å’Œ 100ï¼", "ğŸ¥³")
        return
      }
      // å–®ä¸€é»æ•¸æ¬¡æ•¸
      for(let i=0; i<6; i++) {
        if(counts[i] >= 100 && !achieveState.face100[i]) {
          achieveState.face100[i] = true
          showAchieve(`é»æ•¸${i+1}å‡ºç¾100æ¬¡`, `ä½ éª° ${i+1} é»å·²ç¶“éª°åˆ°å¤©æ€’äººæ€¨\nä¸ç´¯å—`, "ğŸ‘‘")
          return
        }
        if(counts[i] >= 50 && !achieveState.face50[i]) {
          achieveState.face50[i] = true
          showAchieve(`é»æ•¸${i+1}å‡ºç¾50æ¬¡`, `éª° ${i+1} 50æ¬¡äº† ä½ å¤ äº†æ²’`, "ğŸ˜µâ€ğŸ’«")
          return
        }
        if(counts[i] >= 20 && !achieveState.face20[i]) {
          achieveState.face20[i] = true
          showAchieve(`é»æ•¸${i+1}å‡ºç¾20æ¬¡`, `éª° ${i+1} äºŒåæ¬¡ ä½ æœ‰ç—…å§`, "ğŸ¤‘")
          return
        }
        if(counts[i] >= 10 && !achieveState.face10[i]) {
          achieveState.face10[i] = true
          showAchieve(`é»æ•¸${i+1}å‡ºç¾10æ¬¡`, `éª° ${i+1} åæ¬¡è€Œå·² ä¸è¦ä»¥ç‚ºä½ å¾ˆè¡Œ`, "ğŸ¤¡")
          return
        }
      }
    }

    function rollDice() {
      if(rolling) return
      rolling = true
      document.getElementById('btn').disabled = true
      let diceCount = parseInt(document.getElementById('diceCount').value)
      let resultDiv = document.getElementById('result')
      let allDiv = document.getElementById('all')
      let count = 0

      allDiv.innerHTML = ''

      let fake = setInterval(()=>{
        let tmp = []
        for(let i=0;i<diceCount;i++){
          let n = Math.floor(Math.random()*6)+1
          let e = ['âš€','âš','âš‚','âšƒ','âš„','âš…'][n-1]
          tmp.push(`${n} ${e}`)
        }
        resultDiv.innerHTML = `éª°...<br>${tmp.join('ã€€')}`
        count++
        if(count>15){
          clearInterval(fake)
          let real = []
          let sum = 0
          for(let i=0;i<diceCount;i++){
            let n = Math.floor(Math.random()*6)+1
            let e = ['âš€','âš','âš‚','âšƒ','âš„','âš…'][n-1]
            real.push(`${n} ${e}`)
            counts[n-1]++
            sum += n
          }
          totalSum += sum
          resultDiv.innerHTML = `ä½ éª°åˆ°<br>${real.join('ã€€')}`
          allDiv.innerHTML = `é€™æ¬¡ç¸½å’Œï¼š${sum}ã€€${sum==diceCount*6 ? 'é‹æ°£ç‚¸è£‚å•¦' : sum==diceCount ? 'å»è²·æ¨‚é€æ´—è‡‰å§' : 'æ™®æ™®é€šé€šçˆ›é‹'}`
          updateTable()
          checkAchieve()
          rolling = false
          document.getElementById('btn').disabled = false
        }
      },60)
    }
  </script>
  <div id="res" style="font-size:2em; margin:30px 0"></div>
  <a href="index.html" style="display:block; color:#888; margin-top:80px;">å›ä¸»é¸å–®</a>
</body>
</html>
